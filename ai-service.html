<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Risk Control | KhonKaen HiTech</title>

<style>
:root{
  --gold:#d4af37;--red:#ff4d4d;--green:#2ecc71;
}
body{margin:0;font-family:-apple-system,Segoe UI;background:#0c0f14;color:#eee}
header{padding:16px;text-align:center;border-bottom:3px solid var(--gold)}
h1{margin:0;font-size:1.3rem;color:var(--gold)}
small{color:#aaa}
#app{max-width:900px;margin:auto}
.chat{padding:16px;min-height:65vh}
.msg{margin-bottom:14px}
.user{text-align:right}
.bubble{display:inline-block;max-width:85%;padding:14px;border-radius:14px;line-height:1.6}
.user .bubble{background:#27364a;border-bottom-right-radius:4px}
.bot .bubble{background:#1a202c;border-left:5px solid var(--gold)}
.input{display:flex;gap:8px;padding:12px;border-top:1px solid #222}
input{flex:1;padding:14px;font-size:1rem;border-radius:8px;border:none}
button{padding:0 18px;border:none;border-radius:8px;background:var(--gold);font-weight:700}
.cta{margin-top:12px;padding:14px;border:2px solid var(--gold);border-radius:12px;background:#0b0e13}
.cta strong{color:var(--red)}
.cta a{display:block;margin-top:10px;padding:14px;border-radius:8px;
text-align:center;text-decoration:none;font-weight:800}
.call{background:var(--red);color:#fff}
.line{background:var(--green);color:#111}
#dash{position:fixed;bottom:10px;right:10px;
background:#000;padding:10px;border-radius:10px;font-size:.75rem;opacity:.9}
</style>
</head>

<body>

<header>
<h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á</h1>
<small>‡∏Ç‡∏≠‡∏ô‡πÅ‡∏Å‡πà‡∏ô‡πÑ‡∏Æ‡πÄ‡∏ó‡∏Ñ ¬∑ ‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ú‡∏¥‡∏î = ‡πÄ‡∏™‡∏µ‡∏¢‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î</small>
</header>

<div id="app">
<div class="chat" id="chat">
<div class="msg bot"><div class="bubble">
‡∏ú‡∏°‡∏Ñ‡∏∑‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô  
‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏ú‡∏°‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢  
‡πÅ‡∏ï‡πà‡∏Ñ‡∏∑‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ú‡∏¥‡∏î‡∏ó‡∏µ‡πà‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢‡∏´‡∏ô‡∏±‡∏Å  
<br><br>‡πÇ‡∏õ‡∏£‡∏î‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö
</div></div>
</div>

<div class="input">
<input id="input" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏û‡∏ö‚Ä¶" />
<button onclick="send()">‡∏™‡πà‡∏á</button>
</div>
</div>

<div id="dash">
Emergency: <span id="ec">0</span><br>
Normal: <span id="nc">0</span>
</div>

<script>
/* CONFIG */
const API_KEY="PUT_API_KEY";
const PHONE="0944749874";
const LINE="https://line.me/ti/p/~KKHITECH";

/* TIME */
const h=new Date().getHours();
const NIGHT=(h>=20||h<6);

/* STATE */
let LOCK=false,COUNT=0,CASE="NORMAL",RISK=0;
let EM=0,NR=0;

/* SERVICE PROFILES */
const SERVICE={
  electric:{k:["‡πÑ‡∏ü","‡πÄ‡∏ö‡∏£‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå","‡∏™‡∏≤‡∏¢‡πÑ‡∏ü","‡∏ï‡∏π‡πâ‡πÄ‡∏°‡∏ô"],base:7},
  heat:{k:["‡∏£‡πâ‡∏≠‡∏ô","‡πÑ‡∏´‡∏°‡πâ","‡∏Å‡∏•‡∏¥‡πà‡∏ô"],base:8},
  network:{k:["‡πÄ‡∏ô‡πá‡∏ï","wifi","‡∏´‡∏•‡∏∏‡∏î"],base:4},
  general:{k:[],base:3}
};

const EMERGENCY=["‡πÑ‡∏ü‡πÑ‡∏´‡∏°‡πâ","‡∏Ñ‡∏ß‡∏±‡∏ô","‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏¢‡πÑ‡∏ü","‡πÑ‡∏ü‡∏î‡∏π‡∏î","‡∏ä‡πá‡∏≠‡∏ï","‡πÄ‡∏ö‡∏£‡∏Å‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏ï‡∏±‡∏î"];
const HIGH=["‡∏Å‡∏•‡∏±‡∏ß","‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢","‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢","‡∏û‡∏±‡∏á","‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ã‡πà‡∏≠‡∏°","‡∏õ‡∏•‡πà‡∏≠‡∏¢‡πÑ‡∏ß‡πâ"];

function $(id){return document.getElementById(id)}
function add(r,h){
 const d=document.createElement("div");
 d.className="msg "+r;
 d.innerHTML=`<div class="bubble">${h}</div>`;
 $("chat").appendChild(d);
 $("chat").scrollTop=99999;
}

function detectService(t){
 for(let s in SERVICE){
  if(SERVICE[s].k.some(w=>t.includes(w))) return s;
 }
 return "general";
}

async function send(){
 const t=$("input").value.trim(); if(!t||LOCK)return;
 $("input").value="";
 add("user",t);

 COUNT++;
 if(COUNT>=4) LOCK=true;

 if(EMERGENCY.some(w=>t.includes(w))){CASE="EMERGENCY";LOCK=true;}
 else if(HIGH.some(w=>t.includes(w))){LOCK=true;}

 const sv=detectService(t);
 RISK=SERVICE[sv].base+(NIGHT?1:0);

 if(LOCK){
   if(CASE==="EMERGENCY"){
     EM++; $("ec").textContent=EM;
     add("bot",`
‚ö†Ô∏è <strong>‡πÄ‡∏Ñ‡∏™‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô (Risk ${RISK}/10)</strong><br>
${NIGHT?"‡∏ä‡πà‡∏ß‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏≠‡∏≤‡∏à‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ":"‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢"}
<div class="cta">
<strong>‡∏´‡πâ‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏ï‡πà‡∏≠‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏ä‡∏ó</strong>
<a class="call" href="tel:${PHONE}">üìû ‡πÇ‡∏ó‡∏£‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</a>
</div>`);
   }else{
     NR++; $("nc").textContent=NR;
     add("bot",`
‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì <strong>${RISK}/10</strong><br>
‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏Ñ‡∏ß‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
<div class="cta">
<strong>‡∏Å‡∏≤‡∏£‡πÇ‡∏ó‡∏£‡∏Ñ‡∏∑‡∏≠‡∏ó‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</strong>
<a class="call" href="tel:${PHONE}">üìû ‡πÇ‡∏ó‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ä‡πà‡∏≤‡∏á</a>
<a class="line" href="${LINE}">üí¨ LINE</a>
</div>`);
   }
   $("input").disabled=true;
   return;
 }

 try{
 const r=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${API_KEY}`,{
  method:"POST",headers:{"Content-Type":"application/json"},
  body:JSON.stringify({
   contents:[{role:"user",parts:[{text:t}]}],
   systemInstruction:{parts:[{text:"‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ ‡∏û‡∏π‡∏î‡∏™‡∏±‡πâ‡∏ô ‡∏™‡∏∏‡∏Ç‡∏∏‡∏° ‡∏´‡πâ‡∏≤‡∏°‡∏Ç‡∏≤‡∏¢"}]}
  })
 });
 const d=await r.json();
 add("bot",d.candidates?.[0]?.content?.parts?.[0]?.text||"‡∏Ç‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö");
 }catch{
 add("bot","‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏ó‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ä‡πà‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á");
 }
}
</script>

</body>
</html>
